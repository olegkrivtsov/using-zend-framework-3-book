<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="description" content="A free and open-source book about Zend Framework">
<meta name="keywords" content="php,zend framework,book,tutorial,documentation,learn,free">
<meta name="author" content="(c) 2018 by Oleg Krivtsov">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link href="../../favicon.ico" rel="shortcut icon" type="image/ico" />
<link href="../../assets/css/style.css" type="text/css" rel="stylesheet" />
<title>Les différents types de modèles &ndash; Using Zend Framework 3</title>
</head>
<body>
<header>
    <div class="header">
        <div class="header-body">
            <div class="book-title">
                <a href="../../index.html">Using Zend Framework 3</a>
            </div>
            <div class="book-subtitle">
                A free and open-source book about Zend Framework            </div>
            <nav>
                <div class="menu">
                                        <div class="link">
                        <a href="https://olegkrivtsov.github.io/using-zend-framework-3-book/html">Home</a>
                    </div>
                                        <div class="link">
                        <a href="https://github.com/olegkrivtsov/using-zf3-book-samples">Samples</a>
                    </div>
                                        <div class="link">
                        <a href="https://olegkrivtsov.github.io/zf3-api-reference/html/">Class Reference</a>
                    </div>
                                        <div class="link">
                        <a href="https://github.com/olegkrivtsov/using-zend-framework-3-book">Contribute</a>
                    </div>
                    
                </div>
            </nav>
        </div>    
    </div>
</header>    
<div id="container">
<!-- Navigation -->
<div class="navigation">
    <div class="prev-chapter">
        
        <a href="../Modèle_Vue_Controleur/Les_Modèles.html">
            <img alt="Previous Chapter" src="../../assets/images/left.png"><span class="nav-btn-text">Previous</span>
        </a>
        </div>    
    <div class="contents">
        <a href="../toc.html">
            <img alt="Contents" src="../../assets/images/book.png"><span class="nav-btn-text">Contents</span>
        </a>
    </div>
    <div class="next-chapter">
                <a href="../Modèle_Vue_Controleur/Determiner_le_bon_type_de_Modèle.html">
            <span class="nav-btn-text">Next</span><img alt="Next Chapter" src="../../assets/images/right.png">
        </a>
            </div>
        <div class="current-chapter">
        <a href="../Modèle_Vue_Controleur.html">
            <img alt="Contents" src="../../assets/images/upload.png"><span class="nav-btn-text">Modèle-Vue-Controleur</span>
        </a>
    </div>
    </div>

﻿<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<!-- Using Zend Framework 3 Book - Chapter - Adaptive -->
<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-3933778336056438"
     data-ad-slot="4531860323"
     data-ad-format="auto"></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>

<!-- Chapter content -->
<div id="chapter_content">
<div class="incomplete-translation">
    Translation into this language is not yet finished. You can help this project 
    by translating the chapters and contributing your changes.
</div>

<h2 id="Les_différents_types_de_modèles">4.20. Les différents types de modèles</h2>
<p>Avec Zend Framework 3, il n'existe pas de dossier <code>Model</code> unique pour stocker toutes les classes modèles. 
Au lieu de cela, par convention, les modèles sont subdivisés en fonction des principaux types suivants 
et chaque type est stocké dans son propre sous-dossier (voir le tableau 4.9) :</p>
<div class="table-wrapper">
<div class="table-caption">Table 4.9. Types de modèles et emplacements</div><table>
<thead>
<tr>
<th> <em>Types de classe modèle</em>                   </th>
<th> <em>Répertoire</em>                                              </th>
</tr>
</thead>
<tbody>
<tr>
<td>  Entités                       </td>
<td>  <code>APP_DIR/module/Application/src/Entity</code>                  </td>
</tr>
<tr>
<td> Entrepôts                   </td>
<td> <code>APP_DIR/module/Application/src/Repository</code>              </td>
</tr>
<tr>
<td> Objets valeurs                  </td>
<td> <code>APP_DIR/module/Application/src/ValueObject</code>             </td>
</tr>
<tr>
<td> Services                       </td>
<td> <code>APP_DIR/module/Application/src/Service</code>                 </td>
</tr>
<tr>
<td> Fabriques                                                       </td>
<td> Dans un sous-dossier <code>Factory</code> sous chaque dossier de classes.  Par exemple, les fabriques d'un controleur sont placées dans <code>APP_DIR/module/Application/src/Controller/Factory</code>     </td>
</tr>
</tbody>
</table>
</div>
<blockquote class="notquote information" data-type="information"><p> La séparation des modèles en différents types facilite la conception de votre logique métier. 
 On appelle cela le "Domain Driven Design" (ou DDD). 
 Définit par Eric Evans dans son célèbre livre intitulé <em>Domain-Driven Design — Tackling Complexity in the Heart of Software</em>.</p>
</blockquote><p>Nous décrirons ci-dessous les principaux types de modèles.</p>
<h3 id="Les_Entités">4.20.1. Les Entités</h3>
<p>Les <em>entités</em> sont destinées à stocker certaines données et ont toujours une propriété <em>identifiante</em>, 
ce qui vous permet d'identifier les données de manière unique. 
Par exemple, une entité <code>Utilisateur</code> possèdera toujours une propriété <code>login</code> unique qui vous permetra 
d'identifier l'utilisateur par cet attribut. Vous pouvez modifier les autres attributs de cette entité, 
comme le <code>prénom</code> ou l'<code>adresse</code>, mais son identifiant ne change jamais. 
Les entités sont généralement stockées dans une base de données ou dans un système de fichiers.</p>
<p>Ci-dessous, vous pouvez trouver un exemple d'entité <code>User</code>, qui représente un visiteur du site:</p>
<pre class="line-numbers"><code class="language-php">// L'entité User représente un visiteur du site
class User 
{
    // Propriétés
    private $login;     // e.g. "admin"
    private $title;     // e.g. "Mr."
    private $firstName; // e.g. "John"
    private $lastName;  // e.g. "Doe"
    private $country;   // e.g. "USA"
    private $city;      // e.g. "Paris"
    private $postCode;  // e.g. "10543"
    private $address;   // e.g. "Jackson rd."
    
    // Méthodes    
    public function getLogin() 
    {
        return $this-&gt;login;
    }
        
    public function setLogin($login) 
    {
        $this-&gt;login = $login;
    }
    
    //...
}
</code></pre>
<p>Dans les lignes 5-12, nous définissons les propriétés du modèle <code>User</code>. 
La meilleure pratique consiste à définir les propriétés en utilisant le type d'accès privé 
et à les mettre à la disposition de l'appelant via des méthodes publiques <em>getter</em> et <em>setter</em> 
(comme <code>getLogin()</code> et <code>setLogin()</code>).</p>
<blockquote class="notquote information" data-type="information"><p> Les méthodes du modèle ne sont pas limitées par les getters et les setters. 
 Vous pouvez créer d'autres méthodes qui manipulent les données du modèle. 
 Par exemple, vous pouvez définir la méthode pratique <code>getFullName()</code>, qui retournera le nom complet 
 de l'utilisateur ("Mr. John Doe").</p>
</blockquote><h3 id="Les_Entrepôts">4.20.2. Les Entrepôts</h3>
<p>Les classes <em>Entrepôts</em> (Repositories en anglais) sont des modèles spécifiques au stockage et et à la 
récupération des entités. 
Par exemple, un <code>UserRepository</code> peut représenter une table de base de données et fournir des méthodes 
pour extraire des entités <code>User</code>. 
Vous utilisez généralement des repository lorsque vous stockez des entités dans une base de données. 
Avec les repositories, vous pouvez encapsuler la logique de requête SQL au même endroit, la maintenir 
et la tester facilement.</p>
<blockquote class="notquote information" data-type="information"><p> Nous en apprendrons davantage sur les repositories dans <a  href="#doctrine">Gestion des bases de données avec Doctrine</a>, 
 lorsque nous parlerons de la bibliothèque Doctrine.</p>
</blockquote><h3 id="Les_Objets_Valeurs">4.20.3. Les Objets Valeurs</h3>
<p>Les classes <em>Value objects</em> sont en quelques sortes des modèles pour lesquels l'identité n'est pas aussi 
importante que pour les entités. 
Un objet de valeur est généralement une petite classe identifiée par tous ses attributs. 
Il n'a pas d'attribut d'identifiant. Les Value objects ont généralement des méthodes getter, mais n'ont 
pas de setters (les value objects sont immuables).</p>
<p>Par exemple, un modèle qui contient un montant en argent peut être traité comme un value object :</p>
<pre class="line-numbers"><code class="language-php">class MoneyAmount 
{
    // Properties
    private $currency;
    private $amount;
  
    // Constructor
    public function __construct($amount, $currency='USD') 
    {
        $this-&gt;amount = $amount;
        $this-&gt;currency = $currency;
    }
  
    // Gets the currency code  
    public function getCurrency() 
    {
        return $this-&gt;currency;  
    }
  
    // Gets the money amount
    public function getAmount() 
    {
        return $this-&gt;amount;
    }  
}
</code></pre>
<p>Aux lignes 4-5, nous définissons deux propriétés: <code>devise</code> et <code>montant</code>. 
Le modèle n'a pas de propriété d'identifiant, il est plutôt identifié par toutes les propriétés dans leur 
ensemble: si vous changez la <code>devise</code> ou le <code>montant</code>, vous aurez un objet montant différent.</p>
<p>Dans les lignes 8-12, nous définissons la méthode constructeur, qui initialise les propriétés.</p>
<p>Dans les lignes 15-24, nous définissons des méthodes getter pour les propriétés du modèle. 
Notez que nous n'avons pas de méthodes setter (le modèle est immuable).</p>
<h3 id="Les_Services">4.20.4. Les Services</h3>
<p>Les <em>modèles Service</em> usually encapsulent généralement certaines fonctionnalités de la logique métier. 
Les services ont généralement des noms facilement reconnaissables se terminant par un suffixe "er", 
comme <code>FileUploader</code> ou <code>UserManager</code>.</p>
<p>Ci-dessous, un exemple de service <code>Mailer</code> est présenté avec sa classe Value Object. 
Il a la méthode <code>sendMail()</code> qui prend un objet de valeur <code>EmailMessage</code> et qui envoi e-mail en 
utilisant la fonction standard PHP <code>mail()</code> :</p>
<pre class="line-numbers"><code class="language-php">&lt;?php

// The Email message value object
class EmailMessage 
{  
    private $recipient;
    private $subject;
    private $text;  
  
    // Constructor
    public function __construct($recipient, $subject, $text) 
    {
        $this-&gt;recipient = $recipient;
        $this-&gt;subject = $subject;
        $this-&gt;text = $text;
    }
  
    // Getters
    public function getRecipient() 
    {
        return $this-&gt;recipient;
    }
  
    public function getSubject() 
    {
        return $this-&gt;subject;
    }
  
    public function getText() 
    {
        return $this-&gt;text;
    }
}
</code></pre>
<pre class=""><code class="language-php">&lt;?php

// The Mailer service, which can send messages by E-mail
class Mailer 
{
  
    public function sendMail($message) 
    {
        // Use PHP mail() function to send an E-mail
        if(!mail($message-&gt;getRecipient(), $message-&gt;getSubject(), 
             $message()-&gt;getText())) 
        {
            // Error sending message
            return false;
        }
    
        return true;
    }
}
</code></pre>
<blockquote class="notquote tip" data-type="tip"><p> Dans Zend Framework, vous déclarez généralement vos modèles Service dans Service Manager.</p>
</blockquote><h3 id="Les_Fabriques">4.20.5. Les Fabriques</h3>
<p>Les classes <em>Fabriques</em>  sont généralement conçues pour instancier d'autres modèles (en particulier les 
modèles Service). 
Dans les cas les plus simples, vous pouvez créer une instance d'un service sans fabrique, simplement en 
utilisant l'opérateur <code>new</code>, mais parfois la logique de création de classe peut être assez complexe. 
Par exemple, les services dépendent souvent les uns des autres, vous devrez donc peut-être <em>injecter</em> 
des dépendances à un service. 
En outre, il peut parfois être nécessaire d'initialiser le service immédiatement après l'instanciation 
en appelant une (ou plusieurs) de ses méthodes.</p>
<p>Les classes fabriques ont généralement des noms se terminant par le suffixe Factory, comme 
<code>CurrencyConverterFactory</code>, <code>MailerFactory</code>, etc.</p>
<p>Pour un exemple concret, imaginons que nous ayons un service <code>PurchaseManager</code>, qui peut traiter les achats 
de certaines marchandises, et que le service <code>PurchaseManager</code> utilise un autre service appelé 
<code>CurrencyConverter</code>, qui peut se connecter à un système externe fournissant des taux de change. 
Écrivons une classe de fabrique pour <code>PurchaseManager</code>, qui instancierait le service et lui passerait la 
dépendance :</p>
<pre class=""><code class="language-php">&lt;?php
namespace Application\Service\Factory;

use Interop\Container\ContainerInterface;
use Zend\ServiceManager\Factory\FactoryInterface;
use Application\Service\CurrencyConverter;
use Application\Service\PurchaseManager;

/**
 * This is the factory for PurchaseManager service. Its purpose is to instantiate the 
 * service and inject its dependencies.
 */
class PurchaseManagerFactory implements FactoryInterface
{
    public function __invoke(ContainerInterface $container, 
                $requestedName, array $options = null)
    {
        // Get CurrencyConverter service from the service manager.
        $currencyConverter = $container-&gt;get(CurrencyConverter::class);
        
        // Instantiate the service and inject dependencies.
        return new PurchaseManager($currencyConverter);
    }
}
</code></pre>
<p>Dans le code ci-dessus, nous avons la classe <code>PurchaseManagerFactory</code> qui implémente l'interface 
<code>Zend\ServiceManager\Factory\FactoryInterface</code>. 
La classe factory a la méthode <code>__invoke()</code> dont le but est d'instancier l'objet. 
Cette méthode a l'argument <code>$container</code> qui est le gestionnaire de service. 
Vous pouvez utiliser <code>$container</code> pour extraire les services du gestionnaire de service et les transmettre 
à la méthode constructeur du service en cours d'instanciation.</p>
        
</div>

<!-- Ads -->
<div id="ads-chapter-bottom">
<div>
﻿<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<!-- Using Zend Framework 3 Chapter - Bottom - Adaptive -->
<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-3933778336056438"
     data-ad-slot="1546211126"
     data-ad-format="auto"></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
</div>
</div>
    
<!-- Navigation -->
<div class="navigation">
        <div class="current-chapter">
        <a href="../Modèle_Vue_Controleur.html">
            <img alt="Contents" src="../../assets/images/upload.png"><span class="nav-btn-text">Modèle-Vue-Controleur</span>
        </a>
    </div>
        <div class="prev-chapter">
        
        <a href="../Modèle_Vue_Controleur/Les_Modèles.html">
            <img alt="Previous Chapter" src="../../assets/images/left.png"><span class="nav-btn-text">Previous</span>
        </a>
        </div>    
    <div class="contents">
        <a href="../toc.html">
            <img alt="Contents" src="../../assets/images/book.png"><span class="nav-btn-text">Contents</span>
        </a>
    </div>
    <div class="next-chapter">
                <a href="../Modèle_Vue_Controleur/Determiner_le_bon_type_de_Modèle.html">
            <span class="nav-btn-text">Next</span><img alt="Next Chapter" src="../../assets/images/right.png">
        </a>
            </div>        
</div>

<div id="disqus_thread"></div>

        
</div>
<footer>
    <div class="footer">
        <div class="footer-body">
            <div class="copyright">
                Copyright (c) 2018 by Oleg Krivtsov            </div>
            <div class="footer-menu">
                                <div class="footer-link">
                    <a href="https://olegkrivtsov.github.io/using-zend-framework-3-book/legal/terms-and-conditions.html">Terms &amp; Conditions</a>
                </div>
                                <div class="footer-link">
                    <a href="https://olegkrivtsov.github.io/using-zend-framework-3-book/legal/copyright-policy.html">Copyright Policy</a>
                </div>
                                <div class="footer-link">
                    <a href="https://olegkrivtsov.github.io/using-zend-framework-3-book/legal/privacy-policy.html">Privacy Policy</a>
                </div>
                            </div>
            <div class="generated-by">
                Generated using <a href="https://github.com/olegkrivtsov/openbook">OpenBook</a>
            </div>
        </div>    
    </div>
</footer>

<a href="#0" class="cd-top">Top</a>

<script src="../../assets/js/jquery.min.js"></script>
<script src="../../assets/js/loadCSS.js"></script>
<script src="../../assets/js/popup.js"></script>

<script src="../../assets/js/prism.js"></script>

<script>
var disqus_config = function () {
this.page.url = window.location.href; // Replace PAGE_URL with your page's canonical URL variable
this.page.identifier = ''; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
};

(function() { // DON'T EDIT BELOW THIS LINE
var d = document, s = d.createElement('script');

s.src = '//using-zend-framework-3-book.disqus.com/embed.js';

s.setAttribute('data-timestamp', +new Date());
(d.head || d.body).appendChild(s);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>
<script>
loadCSS("../../assets/css/prism.css");
</script>

<script>
jQuery(document).ready(function($){
    // browser window scroll (in pixels) after which the "back to top" link is shown
    var offset = 300,
    //browser window scroll (in pixels) after which the "back to top" link opacity is reduced
    offset_opacity = 1200,
    //duration of the top scrolling animation (in ms)
    scroll_top_duration = 700,
    //grab the "back to top" link
    $back_to_top = $('.cd-top');

    //hide or show the "back to top" link
    $(window).scroll(function(){
            ( $(this).scrollTop() > offset ) ? $back_to_top.addClass('cd-is-visible') : $back_to_top.removeClass('cd-is-visible cd-fade-out');
            if( $(this).scrollTop() > offset_opacity ) { 
                    $back_to_top.addClass('cd-fade-out');
            }
    });

    //smooth scroll to top
    $back_to_top.on('click', function(event){
            event.preventDefault();
            $('body,html').animate({
                    scrollTop: 0 ,
                    }, scroll_top_duration
            );
    });

});
</script>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-80824388-1', 'auto');
  ga('send', 'pageview');

</script>

</body>
</html>    

