<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="description" content="A free and open-source book about Zend Framework">
<meta name="keywords" content="php,zend framework,book,tutorial,documentation,learn,free">
<meta name="author" content="(c) 2018 by Oleg Krivtsov">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link href="../../favicon.ico" rel="shortcut icon" type="image/ico" />
<link href="../../assets/css/style.css" type="text/css" rel="stylesheet" />
<title>Générer des URL à partir d'une route &ndash; Using Zend Framework 3</title>
</head>
<body>
<header>
    <div class="header">
        <div class="header-body">
            <div class="book-title">
                <a href="../../index.html">Using Zend Framework 3</a>
            </div>
            <div class="book-subtitle">
                A free and open-source book about Zend Framework            </div>
            <nav>
                <div class="menu">
                                        <div class="link">
                        <a href="https://olegkrivtsov.github.io/using-zend-framework-3-book/html">Home</a>
                    </div>
                                        <div class="link">
                        <a href="https://github.com/olegkrivtsov/using-zf3-book-samples">Samples</a>
                    </div>
                                        <div class="link">
                        <a href="https://olegkrivtsov.github.io/zf3-api-reference/html/">Class Reference</a>
                    </div>
                                        <div class="link">
                        <a href="https://github.com/olegkrivtsov/using-zend-framework-3-book">Contribute</a>
                    </div>
                    
                </div>
            </nav>
        </div>    
    </div>
</header>    
<div id="container">
<!-- Navigation -->
<div class="navigation">
    <div class="prev-chapter">
        
        <a href="../Routage/Extraire_les_paramètres_d_une_route.html">
            <img alt="Previous Chapter" src="../../assets/images/left.png"><span class="nav-btn-text">Previous</span>
        </a>
        </div>    
    <div class="contents">
        <a href="../toc.html">
            <img alt="Contents" src="../../assets/images/book.png"><span class="nav-btn-text">Contents</span>
        </a>
    </div>
    <div class="next-chapter">
                <a href="../Routage/Ecrire_son_propre_type_de_route.html">
            <span class="nav-btn-text">Next</span><img alt="Next Chapter" src="../../assets/images/right.png">
        </a>
            </div>
        <div class="current-chapter">
        <a href="../Routage.html">
            <img alt="Contents" src="../../assets/images/upload.png"><span class="nav-btn-text">Routage</span>
        </a>
    </div>
    </div>

﻿<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<!-- Using Zend Framework 3 Book - Chapter - Adaptive -->
<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-3933778336056438"
     data-ad-slot="4531860323"
     data-ad-format="auto"></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>

<!-- Chapter content -->
<div id="chapter_content">
<div class="incomplete-translation">
    Translation into this language is not yet finished. You can help this project 
    by translating the chapters and contributing your changes.
</div>

<h2 id="Générer_des_URL_à_partir_d_une_route">5.10. Générer des URL à partir d'une route</h2>
<p>La tâche principale de toute classe de route est de déterminer si une route donnée correspond à la 
requête HTTP, et, lors de la correspondance, de renvoyer l'ensemble des paramètres par lesquels un 
contrôleur et une action peuvent être déterminés. Une autre tâche permise par la classe de route permet 
de générer une URL à partir de paramètres. 
Cette fonctionnalité peut être utilisée dans les méthodes d'action de votre contrôleur pour générer des URL, 
par exemple, pour rediriger un utilisateur vers une autre page. 
Elle peut également être utilisé dans les vues pour générer des liens hypertexte.</p>
<h3 id="Générer_des_URLs_dans_les_vues">5.10.1. Générer des URLs dans les vues</h3>
<p>Vos pages contiennent généralement des hyperliens vers d'autres pages. Ces liens peuvent pointer vers une 
page interne à votre site ou vers une page sur un autre site. 
Un lien hypertexte est représenté par la balise HTML <code>&lt;a&gt;</code> ayant un attribut <code>href</code> spécifiant l'URL de la 
page de destination. Ci-dessous, un exemple de lien hypertexte pointant vers une page externe est présenté :</p>
<p><code>&lt;a href="http://example.com/path/to/page"&gt;Un lien vers une page d'un autre site&lt;/a&gt;</code></p>
<p>Lorsque vous générez un lien hypertexte vers une ressource interne à votre site, 
vous utilisez généralement une URL relative (sans nom d'hôte) :</p>
<p><code>&lt;a href="/path/to/internal/page"&gt;Un lien vers une page interne&lt;/a&gt;</code></p>
<p>Pour générer des URL dans vos vues (fichiers .phtml), vous pouvez utiliser la classe d'aide de vue 
 <code><a target="_blank" href="https://olegkrivtsov.github.io/zf3-api-reference/html/classes/Zend/View/Helper/Url.html" class="api-link">Url</a></code>, qui prend le nom de la route en argument d'entrée:</p>
<pre class="line-numbers"><code class="language-php">&lt;!-- Un lien vers la page d'accueil --&gt;
&lt;a href="&lt;?= $this-&gt;url('home'); ?&gt;"&gt;Accueil&lt;/a&gt;

&lt;!-- Un lien vers la page A Propos --&gt;
&lt;a href="&lt;?= $this-&gt;url('about'); ?&gt;"&gt;A Propos&lt;/a&gt;
</code></pre>
<p>Dans les lignes ci-dessus, nous générons deux URL relatives. A la ligne 2, nous appelons l'aide de vue 
<code><a target="_blank" href="https://olegkrivtsov.github.io/zf3-api-reference/html/classes/Zend/View/Helper/Url.html" class="api-link">Url</a></code> et transmettons le nom de la route "home" comme paramètre. 
A la ligne 5, nous passons le nom de la route "about" comme argument pour l'aide de vue <code><a target="_blank" href="https://olegkrivtsov.github.io/zf3-api-reference/html/classes/Zend/View/Helper/Url.html" class="api-link">Url</a></code>.</p>
<blockquote class="notquote information" data-type="information"><p> Dans l'exemple ci-dessus, l'aide de vue <code><a target="_blank" href="https://olegkrivtsov.github.io/zf3-api-reference/html/classes/Zend/View/Helper/Url.html" class="api-link">Url</a></code> utilise en interne l'objet 
 <code><a target="_blank" href="https://olegkrivtsov.github.io/zf3-api-reference/html/classes/Zend/Router/RouteMatch.html" class="api-link">RouteMatch</a></code> et appelle la route <code><a target="_blank" href="https://olegkrivtsov.github.io/zf3-api-reference/html/classes/Zend/Router/Http/Literal.html" class="api-link">Literal</a></code> pour 
 assembler l'URL en fonction du nom de la route.</p>
</blockquote><p>Une fois que la classe <code><a target="_blank" href="https://olegkrivtsov.github.io/zf3-api-reference/html/classes/Zend/View/Renderer/PhpRenderer.html" class="api-link">PhpRenderer</a></code> exécute le code de la vue, le balisage HTML de sortie sera le suivant :</p>
<pre class=""><code class="language-php">&lt;!-- Le lien vers la page d'accueil --&gt;
&lt;a href="/"&gt;Home page&lt;/a&gt;

&lt;!-- Le lien vers la page A propos --&gt;
&lt;a href="/about"&gt;About page&lt;/a&gt;
</code></pre>
<h4 id="Passer_des_paramètres">5.10.1.1. Passer des paramètres</h4>
<p>Si une route utilise des paramètres variables, vous devez les passer à l'aide de vue <code><a target="_blank" href="https://olegkrivtsov.github.io/zf3-api-reference/html/classes/Zend/View/Helper/Url.html" class="api-link">Url</a></code> 
en tant que deuxième argument :</p>
<pre class="line-numbers"><code class="language-php">&lt;!-- Un lien vers la page A propos --&gt;
&lt;a href="&lt;?= $this-&gt;url('application', ['action' =&gt; 'about']); ?&gt;" &gt;
  A propos 
&lt;/a&gt;

&lt;!-- Un lien vers l'image de code-barre --&gt;
&lt;a href="&lt;?= $this-&gt;url('application', ['action' =&gt; 'barcode',
  'type' =&gt; 'code39', 'text' =&gt; 'HELLO-WORLD']); ?&gt;" &gt;
  Barcode image &lt;/a&gt;
</code></pre>
<p>Dans l'exemple ci-dessus, nous utilisons l'aide de vue <code><a target="_blank" href="https://olegkrivtsov.github.io/zf3-api-reference/html/classes/Zend/View/Helper/Url.html" class="api-link">Url</a></code> pour générer les deux 
URL par nom de route et par paramètres. Nous passons le nom de la route "application" comme premier argument, 
et un tableau de paramètres comme deuxième argument.</p>
<p>A la ligne 2, nous passons le paramètre "action" pour indiquer à la classe de route <em>Segment</em> qu'elle doit 
remplacer le caractère générique correspondant dans la route par la chaîne "about".</p>
<p>Une fois que la classe <code><a target="_blank" href="https://olegkrivtsov.github.io/zf3-api-reference/html/classes/Zend/View/Renderer/PhpRenderer.html" class="api-link">PhpRenderer</a></code> aura exécuté le code de la vue, le code HTML de sortie sera le suivant :</p>
<pre class=""><code class="language-php">&lt;!-- Un lien vers la page A propos --&gt;
&lt;a href="/application/about" &gt; A propos &lt;/a&gt;

&lt;!-- Un lien vers l'image de code-barre --&gt;
&lt;a href="/application/barcode/code39/HELLO-WORLD" &gt; Barcode image &lt;/a&gt;
</code></pre>
<p>Comme autre exemple, essayons de générer une URL pour notre route <em>Regex</em> (celle qui sert nos pages 
"statiques") :</p>
<pre class=""><code class="language-php">&lt;!-- Un lien vers la page Introduction --&gt;
&lt;a href="&lt;?= $this-&gt;url('doc', ['page'=&gt;'introduction']); ?&gt;"&gt;
 Introduction &lt;/a&gt;			  
</code></pre>
<p>Cela générera le code HTML suivant :</p>
<pre class=""><code class="language-php">&lt;!-- Un lien vers la page Introduction --&gt;
&lt;a href="/doc/introduction.html"&gt; Introduction &lt;/a&gt;
</code></pre>
<h4 id="Générer_des_URLs_absolues">5.10.1.2. Générer des URLs absolues</h4>
<p>Si vous avez besoin de générer une URL absolue (avec le schéma et le nom d'hôte), vous pouvez spécifier un 
troisième paramètre à l'aide de vue <code><a target="_blank" href="https://olegkrivtsov.github.io/zf3-api-reference/html/classes/Zend/View/Helper/Url.html" class="api-link">Url</a></code>. Le troisième paramètre doit être un 
tableau contenant une ou plusieurs options. Pour assembler l'URL absolue, transmettez l'option 
<code>force_canonical</code>, comme dans l'exemple ci-dessous :</p>
<pre class="line-numbers"><code class="language-php">&lt;!-- Un lien vers la page d'Accueil --&gt;
&lt;a href="&lt;?= $this-&gt;url('home', [], ['force_canonical' =&gt; true]); ?&gt;" &gt; 
  Accueil &lt;/a&gt;
  
&lt;!-- Un lien vers la page A Propos --&gt;
&lt;a href="&lt;?php echo $this-&gt;url('application', ['action' =&gt; 'about'],
  ['force_canonical' =&gt; true]); ?&gt;" &gt; A Propos &lt;/a&gt;
</code></pre>
<p>A la ligne 2 de l'exemple ci-dessus, nous transmettons le nom de la route "home" comme premier argument, 
un tableau vide comme deuxième argument et un tableau contenant l'option <code>force_canonical</code> comme troisième 
argument. Dans les lignes 6-7, nous passons également l'option <code>force_canonical</code> comme troisième argument 
pour générer l'URL de la page À propos.</p>
<p>Le code HTML résultant du code ci-dessus sera le suivant :</p>
<pre class=""><code class="language-php">&lt;!-- Un lien vers la page d'Accueil --&gt;
&lt;a href="http://localhost/" &gt; Accueil &lt;/a&gt;
  
&lt;!-- Un lien vers la page A Propos --&gt;
&lt;a href="http://localhost/application/index/about" &gt; A Propos &lt;/a&gt;
</code></pre>
<h4 id="Spécifier_des_paramêtres_de_requête">5.10.1.3. Spécifier des paramêtres de requête</h4>
<p>Si vous souhaitez que votre URL contienne un parametre de requête, vous pouvez spécifier l'option <code>query</code> 
dans le troisième argument de l'aide de vue <code>Url</code>. Par exemple, supposons que vous ayez l'action "search" 
dans un contrôleur (et une route mappée à cette action), et que vous souhaitiez passer un paramêtre de 
recherche et un nombre de résultats par page. L'URL de cette action serait la suivante: 
"http://localhost/search?q=topic&amp;count=10". Pour générer cette URL, vous utilisez le code suivant :</p>
<pre class=""><code class="language-php">&lt;a href="&lt;?= $this-&gt;url('search', [], ['force_canonical' =&gt; true, 
         'query'=&gt;['q'=&gt;'topic', 'count'=&gt;10]]); ?&gt;" &gt; 
  Search &lt;/a&gt;
</code></pre>
<p>Dans le code ci-dessus, nous avons spécifié l'option <code>query</code>, qui est le tableau contenant les paires 
<em>nom =&gt; valeur</em> des paramètres de la requête.</p>
<h3 id="Générer_des_URLs_depuis_les_contrôleurs">5.10.2. Générer des URLs depuis les contrôleurs</h3>
<p>Vous pouvez générer des URL dans les méthodes d'action de votre contrôleur à l'aide du plug-in de contrôleur 
<code>Url</code>. Pour générer une URL, vous appelez la méthode <code>fromRoute()</code> du plugin <code>Url</code>, comme dans l'exemple 
ci-dessous :</p>
<pre class=""><code class="language-php">// Un exemple de méthode d'action
public function someAction() 
{
    // Génére une URL qui pointe vers la page d'accueil ('/')
    $url1 = $this-&gt;url()-&gt;fromRoute('home');
  
    // Génére une URL absolue pointant vers la page À propos
    // ('http://localhost/application/about')
    $url2 = $this-&gt;url()-&gt;fromRoute('application', 
              ['action'=&gt;'about'], ['force_canonical'=&gt;true]);
}
</code></pre>
<blockquote class="notquote tip" data-type="tip"><p> Les arguments pris par le plugin <code>Url</code> et leur signification sont identiques à ceux de l'aide de vue 
 <code><a target="_blank" href="https://olegkrivtsov.github.io/zf3-api-reference/html/classes/Zend/View/Helper/Url.html" class="api-link">Url</a></code>. Ainsi, vous pouvez générer des URL absolues ou relatives de la même manière 
 que dans vos vues.</p>
</blockquote><h3 id="Encodage_d_URL">5.10.3. Encodage d'URL</h3>
<p>Lorsque vous générez des URL avec l'aide de vue <code><a target="_blank" href="https://olegkrivtsov.github.io/zf3-api-reference/html/classes/Zend/View/Helper/Url.html" class="api-link">Url</a></code> ou avec le plugin de contrôleur 
<code><a target="_blank" href="https://olegkrivtsov.github.io/zf3-api-reference/html/classes/Zend/Mvc/Controller/Plugin/Url.html" class="api-link">Url</a></code>, vous devez vous souvenir que les URL ne peuvent contenir que des 
caractères «sécurisés» du jeu de caractères ASCII. Ainsi, si vous passez un paramètre contenant des 
caractères dangereux, ces caractères seront remplacés par un pourcentage suivi de deux chiffres.</p>
<p>Par exemple, essayons de générer une URL pour notre route <em>Regex</em> et passons le paramètre "page" avec la 
valeur "/chapter1/introduction".</p>
<pre class=""><code class="language-php">&lt;!-- Un lien vers la page Introduction --&gt;
&lt;a href="&lt;?= $this-&gt;url('doc', ['page'=&gt;'chapter1/introduction']); ?&gt;"&gt;
  Introduction &lt;/a&gt;			  
</code></pre>
<p>Nous pourrions supposer qu'il génère une URL comme "/doc/chapter1/introduction.html". Mais comme le 
caractère slash ('/') est dangereux, il sera remplacé par les caractères "%2F" pour des raisons de sécurité 
et nous aurons le code HTML suivant :</p>
<pre class=""><code class="language-text">&lt;!-- Un lien vers la page Introduction --&gt;
&lt;a href="/doc/chapter1%2Fintroduction.html"&gt; Introduction &lt;/a&gt;
</code></pre>
<p>Malheureusement, ce lien hypertexte est inutilisable car il ne correspondra pas à notre route <em>Regex</em>.</p>
        
</div>

<!-- Ads -->
<div id="ads-chapter-bottom">
<div>
﻿<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<!-- Using Zend Framework 3 Chapter - Bottom - Adaptive -->
<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-3933778336056438"
     data-ad-slot="1546211126"
     data-ad-format="auto"></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
</div>
</div>
    
<!-- Navigation -->
<div class="navigation">
        <div class="current-chapter">
        <a href="../Routage.html">
            <img alt="Contents" src="../../assets/images/upload.png"><span class="nav-btn-text">Routage</span>
        </a>
    </div>
        <div class="prev-chapter">
        
        <a href="../Routage/Extraire_les_paramètres_d_une_route.html">
            <img alt="Previous Chapter" src="../../assets/images/left.png"><span class="nav-btn-text">Previous</span>
        </a>
        </div>    
    <div class="contents">
        <a href="../toc.html">
            <img alt="Contents" src="../../assets/images/book.png"><span class="nav-btn-text">Contents</span>
        </a>
    </div>
    <div class="next-chapter">
                <a href="../Routage/Ecrire_son_propre_type_de_route.html">
            <span class="nav-btn-text">Next</span><img alt="Next Chapter" src="../../assets/images/right.png">
        </a>
            </div>        
</div>

<div id="disqus_thread"></div>

        
</div>
<footer>
    <div class="footer">
        <div class="footer-body">
            <div class="copyright">
                Copyright (c) 2018 by Oleg Krivtsov            </div>
            <div class="generated-by">
                Generated using <a href="https://github.com/olegkrivtsov/openbook">OpenBook</a>
            </div>
        </div>    
    </div>
</footer>

<a href="#0" class="cd-top">Top</a>

<script src="../../assets/js/jquery.min.js"></script>
<script src="../../assets/js/loadCSS.js"></script>
<script src="../../assets/js/popup.js"></script>

<script src="../../assets/js/prism.js"></script>

<script>
var disqus_config = function () {
this.page.url = window.location.href; // Replace PAGE_URL with your page's canonical URL variable
this.page.identifier = ''; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
};

(function() { // DON'T EDIT BELOW THIS LINE
var d = document, s = d.createElement('script');

s.src = '//using-zend-framework-3-book.disqus.com/embed.js';

s.setAttribute('data-timestamp', +new Date());
(d.head || d.body).appendChild(s);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>
<script>
loadCSS("../../assets/css/prism.css");
</script>

<script>
jQuery(document).ready(function($){
    // browser window scroll (in pixels) after which the "back to top" link is shown
    var offset = 300,
    //browser window scroll (in pixels) after which the "back to top" link opacity is reduced
    offset_opacity = 1200,
    //duration of the top scrolling animation (in ms)
    scroll_top_duration = 700,
    //grab the "back to top" link
    $back_to_top = $('.cd-top');

    //hide or show the "back to top" link
    $(window).scroll(function(){
            ( $(this).scrollTop() > offset ) ? $back_to_top.addClass('cd-is-visible') : $back_to_top.removeClass('cd-is-visible cd-fade-out');
            if( $(this).scrollTop() > offset_opacity ) { 
                    $back_to_top.addClass('cd-fade-out');
            }
    });

    //smooth scroll to top
    $back_to_top.on('click', function(event){
            event.preventDefault();
            $('body,html').animate({
                    scrollTop: 0 ,
                    }, scroll_top_duration
            );
    });

});
</script>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-80824388-1', 'auto');
  ga('send', 'pageview');

</script>

</body>
</html>    

