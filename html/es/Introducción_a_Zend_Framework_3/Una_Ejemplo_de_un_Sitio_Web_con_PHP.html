<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="description" content="A free and open-source book about Zend Framework">
<meta name="keywords" content="php,zend framework,book,tutorial,documentation,learn,free">
<meta name="author" content="(c) 2017 by Oleg Krivtsov">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link href="../../favicon.ico" rel="shortcut icon" type="image/ico" />
<link href="../../assets/css/style.css" type="text/css" rel="stylesheet" />
<title>Una Ejemplo de un Sitio Web con PHP -- Using Zend Framework 3</title>
</head>
<body>
<header>
    <div class="header">
        <div class="header-body">
            <div class="book-title">
                <a href="../../index.html">Using Zend Framework 3</a>
            </div>
            <div class="book-subtitle">
                A free and open-source book about Zend Framework            </div>
            <nav>
                <div class="menu">
                                        <div class="link">
                        <a href="https://olegkrivtsov.github.io/using-zend-framework-3-book/html">Read</a>
                    </div>
                                        <div class="link">
                        <a href="https://github.com/olegkrivtsov/using-zf3-book-samples">Samples</a>
                    </div>
                                        <div class="link">
                        <a href="https://github.com/olegkrivtsov/using-zend-framework-3-book">Contribute</a>
                    </div>
                    
                </div>
            </nav>
        </div>    
    </div>
</header>    
<div id="container">
<!-- Navigation -->
<div class="navigation">
    <div class="prev-chapter">
        
        <a href="../Introducción_a_Zend_Framework_3/_Qué_es_Zend_Framework_3_.html">
            <img alt="Previous Chapter" src="../../assets/images/left.png"><span class="nav-btn-text">Previous</span>
        </a>
        </div>    
    <div class="contents">
        <a href="../toc.html">
            <img alt="Contents" src="../../assets/images/book.png"><span class="nav-btn-text">Contents</span>
        </a>
    </div>
    <div class="next-chapter">
                <a href="../Introducción_a_Zend_Framework_3/Licencia.html">
            <span class="nav-btn-text">Next</span><img alt="Next Chapter" src="../../assets/images/right.png">
        </a>
            </div>
        <div class="current-chapter">
        <a href="../Introducción_a_Zend_Framework_3.html">
            <img alt="Contents" src="../../assets/images/upload.png"><span class="nav-btn-text">Introducción a Zend Framework 3</span>
        </a>
    </div>
    </div>

﻿<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<!-- Using Zend Framework 3 Book - Chapter - Adaptive -->
<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-3933778336056438"
     data-ad-slot="4531860323"
     data-ad-format="auto"></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>

<!-- Chapter content -->
<div id="chapter_content">
<div class="incomplete-translation">
    Translation into this language is not yet finished. You can help this project 
    by translating the chapters and contributing your changes.
</div>

<h2 id="Una_Ejemplo_de_un_Sitio_Web_con_PHP">1.2. Una Ejemplo de un Sitio Web con PHP</h2>
<p>Para demostrar cuán difícil es escribir un sitio web <em>sin</em> un framework
de PHP escribiremos una aplicación web muy simple que consiste en tres páginas
HTML: <em>Home</em>, <em>Login</em> y <em>Logout</em>. Para este ejemplo, no usaremos ningún
framework e intentaremos usar solo PHP "puro".</p>
<blockquote class="notquote information" data-type="information"><p> No nos confundamos, escribir un sitio web con un framework de PHP puede
 ser difícil pero con un framework lo haremos de una manera segura y
 consistente.</p>
</blockquote><h3 id="Página_Principal">1.2.1. Página Principal</h3>
<blockquote class="notquote information" data-type="information"><p> Cuando escribimos un sitio web con PHP colocamos el código dentro de un
 archivo con extensión <code>.php</code>. Este archivo se llama <em>script</em> de PHP.</p>
</blockquote><p>Primero vamos a implementar la página <em>Home</em> para nuestro sitio web. Para
hacer esto creamos el archivo <code>index.php</code> en la carpeta raíz de documentos de
Apache y colocamos el siguiente código dentro de él.</p>
<blockquote class="notquote tip" data-type="tip"><p> Para entender el código de abajo necesitamos tener alguna experiencia
 con PHP. Si no tenemos experiencia con PHP sería bueno revisar algún
 tutorial de PHP como <a href="http://www.w3schools.com/php/">w3schools.com</a>.</p>
</blockquote><pre class=""><code class="language-php">&lt;?php
// index.php
session_start();

// If user is logged in, retrieve identity from session.
$identity = null;
if (isset($_SESSION['identity'])) {
    $identity = $_SESSION['identity'];
}
?&gt;

&lt;!DOCTYPE html&gt;
&lt;html&gt;
    &lt;head&gt;
        &lt;title&gt;Home page&lt;/title&gt;
    &lt;/head&gt;
    &lt;body&gt;
        &lt;h1&gt;Home&lt;/h1&gt;
        &lt;?php if ($identity==null): ?&gt;
        &lt;a href="login.php"&gt;Sign in&lt;/a&gt;
        &lt;?php else: ?&gt;
        &lt;strong&gt;Welcome, &lt;?= $identity ?&gt;&lt;/strong&gt; &lt;a href="logout.php"&gt;Sign out&lt;/a&gt;
        &lt;?php endif; ?&gt;

        &lt;p&gt;
            This is a simple website to demonstrate the advantages of a PHP framework
            and disadvantages of "pure" PHP.
        &lt;/p&gt;
    &lt;/body&gt;
&lt;/html&gt;
</code></pre>
<p>Si escribimos <em>http://localhost/index.php</em> en nuestro navegador web (como
Firefox o Google Chrome) deberíamos ver una página como la siguiente:</p>
<p><span class="image-wrapper">
<a target="_blank" href="../../en/images/intro/simple_home_page.png">
<img src="../../en/images/intro/simple_home_page.png" alt="Una Página Home Simple" /></a>
<span class="image-caption">Una Página Home Simple</span>
</span>
</p>
<h3 id="Página_de_Inicio_de_Sesión">1.2.2. Página de Inicio de Sesión</h3>
<p>Ahora vamos a implementar la página de <em>Login</em>. Esta página podría tener un
formulario con los campos <em>E-mail</em> y <em>Contraseña</em>. Una vez que el usuario
envía el formulario y pasa el proceso de autenticación su identidad se
guarda en la variables sesión de PHP. El script podría tener el siguiente
aspecto:</p>
<pre class=""><code class="language-php">&lt;?php
// login.php
session_start();

// If user is logged in, redirect him to index.php
if (isset($_SESSION['identity'])) {
    header('Location: index.php');
    exit;
}

// Check if form is submitted.
$submitted = false;
if ($_SERVER['REQUEST_METHOD']=='POST') {

    $submitted = true;

    // Extract form data.
    $email = $_POST['email'];
    $password = $_POST['password'];

    // Authenticate user.
    $authenticated = false;
    if ($email=='admin@example.com' &amp;&amp; $password=='Secur1ty') {
        $authenticated = true;

        // Save identity to session.
        $_SESSION['identity'] = $email;

        // Redirect the user to index.php.
        header('Location: index.php');
        exit;
    }
}
?&gt;

&lt;!DOCTYPE html&gt;
&lt;html&gt;
    &lt;head&gt;
        &lt;title&gt;Login page&lt;/title&gt;
    &lt;/head&gt;
    &lt;body&gt;
        &lt;h1&gt;Sign in&lt;/h1&gt;
        &lt;?php if ($submitted &amp;&amp; !$authenticated): ?&gt;
            &lt;div class="alert"&gt;
                Invalid credentials.
            &lt;/div&gt;
        &lt;?php endif; ?&gt;
        &lt;form name="login-form" action="/login.php" method="POST"&gt;
            &lt;label for="email"&gt;E-mail&lt;/label&gt;
            &lt;input type="text" name="email"&gt;
            &lt;br&gt;
            &lt;label for="password"&gt;Password&lt;/label&gt;
            &lt;input type="password" name="password"&gt;
            &lt;br&gt;
            &lt;input type="submit" name="submit" value="Sign In"&gt;
        &lt;/form&gt;
    &lt;/body&gt;
&lt;/html&gt;
</code></pre>
<p>Si abrimos la URL <em>http://localhost/login.php</em> en nuestro navegador deberíamos
ver algo como:</p>
<p><span class="image-wrapper">
<a target="_blank" href="../../en/images/intro/simple_login_page.png">
<img src="../../en/images/intro/simple_login_page.png" alt="Una Página Simple de Login" /></a>
<span class="image-caption">Una Página Simple de Login</span>
</span>
</p>
<blockquote class="notquote tip" data-type="tip"><p> Para iniciar sesión usamos el E-mail y contraseña <code>admin@example.com</code>
 y <code>Secur1ty</code> respectivamente.</p>
</blockquote><h3 id="Página_para_Cerrar_Sesión">1.2.3. Página para Cerrar Sesión</h3>
<p>Y finalmente vamos a implementar la página <em>Logout</em> que limpiará la identidad
del usuario:</p>
<pre class=""><code class="language-php">&lt;?php
// logout.php
session_start();

unset($_SESSION['identity']);
header('Location: index.php');
exit;
</code></pre>
<blockquote class="notquote tip" data-type="tip"><p> El código completo de este sitio web se puede encontrar en el ejemplo
 <a href="https://github.com/olegkrivtsov/using-zf3-book-samples/tree/master/purephp">Pure PHP</a>
 que acompaña a este libro.</p>
</blockquote><h3 id="Reviewing_the_Code">1.2.4. Reviewing the Code</h3>
<p>El script de arriba no solo es un ejemplo típico de una sitio web con PHP "puro",
además, es un ejemplo de como <em>no deberíamos</em> escribir nuestro sitio web
(incluso un sitio web simple). Pero, ¿Que hay de malo con esto?</p>
<ol>
<li><p>Los scripts <code>index.php</code> y <code>login.php</code> tienden a mezclar todo el código en
un solo archivo. No estamos aplicando separación de conceptos lo que hace
a nuestro código mucho más complejo. Intuitivamente podemos entender que
podría ser más conveniente separar el código responsable de la autenticación
del usuario y el código responsable de la presentación (impresión del HTML).</p>
</li>
<li><p>Las direcciones URL de nuestras páginas web no se ven bien (por ejemplo,
<code>http://localhost/index.php</code>). Nos gustaría esconder la extensión <code>.php</code>.
Ademas, ¿que sucede cuando un usuario intenta visitar una página que no
existe? En este caso nos gustaría redirigir al usuario a una página de
error.</p>
</li>
<li><p>¿Que sucede si nuestro sitio web crece en tamaño? ¿Como podríamos organizar
el código? ¿un script PHP por cada página web? Y que si queremos reusar
algunos de nuestros script PHP en otros sitios web sin cambios? Intuitivamente
podríamos entender que podría ser útil organizar el código en algún tipo de
<em>módulos</em> reusables.</p>
</li>
<li><p>Ambos scripts, <code>index.php</code> y <code>login.php</code>, contienen código HTML común. ¿Por qué
copiar y pegar este código de presentación en cada script PHP? Nos
gustaría reusar la misma plantilla maestra en todas o en la mayoría de las
páginas.</p>
</li>
<li><p>El script <code>login.php</code> tiene problemas de seguridad, porque no implementamos
ninguna validación para las variables POST. Igualmente las sesiones de PHP pueden
ser objeto de cracking. Además, el script PHP <code>login.php</code> está dentro de la
carpeta raíz de documentos de Apache lo que no es muy seguro (es mejor
colocarlo en un lugar que no sea accesible para los usuarios web). Además, el
<code>index.php</code> es inseguro porque no se filtra la salida PHP lo que lo hace
vulnerable a ataques XSS.</p>
</li>
<li><p>Ninguno de estos scripts usa clases PHP. En teoría si se encapsulan
funcionalidades dentro de clases el código estaría mejor estructurado y
sería más fácil de mantener.</p>
</li>
<li><p>En estos scripts debemos escribir nuestra propia implementación de la
autenticación y así de las otras funcionalidades. ¿Por qué reinventar la
rueda y no usar una biblioteca bien diseñada para esto?</p>
</li>
</ol>
<p>Los problemas de arriba se resuelven fácilmente cuando escribimos un sitio web
con un framework (como Zend Framework 3):</p>
<ol>
<li><p>En ZF3 usamos el patrón de diseño <em>Modelo-Vista-Controlador</em> separando el
código PHP en modelos (el código responsable de la autenticación debería ir
aquí), vistas (el código responsable de la impresión del HTML debería ir
aquí) y los controladores (el código responsable de recuperar las variables
POST debería ir aquí).</p>
</li>
<li><p>El <em>enrutamiento</em> de ZF3 permite tener URL con un aspecto profesional, esto
se consigue ocultando la extensión <code>.php</code>. Como las URLs se pueden parecer
se definen mediante reglas estrictas. Si un usuario intenta ver una página
que no existe es automáticamente redirecionado a la página de error
estándar.</p>
</li>
<li><p>En ZF3 podemos usar el concepto de <em>módulo</em>. Este permite convenientemente
separar nuestros modelos, vistas y controladores en unidades autónomas
(módulos) y reusar con facilidad esta unidad en otro proyecto.</p>
</li>
<li><p>En ZF3 podemos definir una <em>maqueta</em> de plantilla de vista común y reusarla
en todas o en la mayoría de las páginas web.</p>
</li>
<li><p>ZF3 nos provee de varias características de seguridad como filtros de
de formulario y validadores, escapar la salida, validadores de sesión,
algoritmos criptográficos, etc. En un sitio web con ZF3 solamente el <code>index.php</code>
es accesible para los usuarios web, todos los otros script de PHP se
almacenan fuera de la carpeta raíz de documentos de Apache.</p>
</li>
<li><p>En un sitio web con ZF3 colocamos el código dentro de clases dejándolo
mejor organizado.</p>
</li>
<li><p>ZF3 nos provee de muchos componentes que podemos usar en nuestro sitio web:
un componente de autenticación, un componente para trabajar con formularios,
etc.</p>
</li>
</ol>
<blockquote class="notquote tip" data-type="tip"><p> Ahora que tenemos una idea de las ventajas de usar Zend Framework 3 y lo que
 él puede hacer por nosotros dedicaremos la siguiente sección a describir
 ZF3 con más detalles.</p>
</blockquote>        
</div>

<!-- Ads -->
<div id="ads-chapter-bottom">
<div>
﻿<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<!-- Using Zend Framework 3 Chapter - Bottom - Adaptive -->
<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-3933778336056438"
     data-ad-slot="1546211126"
     data-ad-format="auto"></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script></div>
</div>
    
<!-- Navigation -->
<div class="navigation">
        <div class="current-chapter">
        <a href="../Introducción_a_Zend_Framework_3.html">
            <img alt="Contents" src="../../assets/images/upload.png"><span class="nav-btn-text">Introducción a Zend Framework 3</span>
        </a>
    </div>
        <div class="prev-chapter">
        
        <a href="../Introducción_a_Zend_Framework_3/_Qué_es_Zend_Framework_3_.html">
            <img alt="Previous Chapter" src="../../assets/images/left.png"><span class="nav-btn-text">Previous</span>
        </a>
        </div>    
    <div class="contents">
        <a href="../toc.html">
            <img alt="Contents" src="../../assets/images/book.png"><span class="nav-btn-text">Contents</span>
        </a>
    </div>
    <div class="next-chapter">
                <a href="../Introducción_a_Zend_Framework_3/Licencia.html">
            <span class="nav-btn-text">Next</span><img alt="Next Chapter" src="../../assets/images/right.png">
        </a>
            </div>        
</div>

<div id="disqus_thread"></div>

        
</div>
<footer>
    <div class="footer">
        <div class="footer-body">
            <div class="copyright">
                Copyright (c) 2017 by Oleg Krivtsov            </div>
            <div class="generated-by">
                Generated using <a href="https://github.com/olegkrivtsov/openbook">OpenBook</a>
            </div>
        </div>    
    </div>
</footer>

<a href="#0" class="cd-top">Top</a>

<script src="../../assets/js/jquery.min.js"></script>
<script src="../../assets/js/loadCSS.js"></script>

<script src="../../assets/js/prism.js"></script>

<script>
var disqus_config = function () {
this.page.url = window.location.href; // Replace PAGE_URL with your page's canonical URL variable
this.page.identifier = ''; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
};

(function() { // DON'T EDIT BELOW THIS LINE
var d = document, s = d.createElement('script');

s.src = '//using-zend-framework-3-book.disqus.com/embed.js';

s.setAttribute('data-timestamp', +new Date());
(d.head || d.body).appendChild(s);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>
<script>
loadCSS("../../assets/css/prism.css");
</script>

<script>
jQuery(document).ready(function($){
    // browser window scroll (in pixels) after which the "back to top" link is shown
    var offset = 300,
    //browser window scroll (in pixels) after which the "back to top" link opacity is reduced
    offset_opacity = 1200,
    //duration of the top scrolling animation (in ms)
    scroll_top_duration = 700,
    //grab the "back to top" link
    $back_to_top = $('.cd-top');

    //hide or show the "back to top" link
    $(window).scroll(function(){
            ( $(this).scrollTop() > offset ) ? $back_to_top.addClass('cd-is-visible') : $back_to_top.removeClass('cd-is-visible cd-fade-out');
            if( $(this).scrollTop() > offset_opacity ) { 
                    $back_to_top.addClass('cd-fade-out');
            }
    });

    //smooth scroll to top
    $back_to_top.on('click', function(event){
            event.preventDefault();
            $('body,html').animate({
                    scrollTop: 0 ,
                    }, scroll_top_duration
            );
    });

});
</script>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-80824388-1', 'auto');
  ga('send', 'pageview');

</script>

</body>
</html>    

