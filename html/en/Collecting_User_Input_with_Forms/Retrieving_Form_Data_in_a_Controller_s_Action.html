<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="description" content="A free and open-source book about Zend Framework">
<meta name="keywords" content="php,zend framework,book,tutorial,documentation,learn,free">
<meta name="author" content="(c) 2018 by Oleg Krivtsov">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link href="../../favicon.ico" rel="shortcut icon" type="image/ico" />
<link href="../../assets/css/style.css" type="text/css" rel="stylesheet" />
<title>Retrieving Form Data in a Controller's Action -- Using Zend Framework 3</title>
</head>
<body>
<header>
    <div class="header">
        <div class="header-body">
            <div class="book-title">
                <a href="../../index.html">Using Zend Framework 3</a>
            </div>
            <div class="book-subtitle">
                A free and open-source book about Zend Framework            </div>
            <nav>
                <div class="menu">
                                        <div class="link">
                        <a href="https://olegkrivtsov.github.io/using-zend-framework-3-book/html">Read</a>
                    </div>
                                        <div class="link">
                        <a href="https://github.com/olegkrivtsov/using-zf3-book-samples">Samples</a>
                    </div>
                                        <div class="link">
                        <a href="https://github.com/olegkrivtsov/using-zend-framework-3-book">Contribute</a>
                    </div>
                    
                </div>
            </nav>
        </div>    
    </div>
</header>    
<div id="container">
<!-- Navigation -->
<div class="navigation">
    <div class="prev-chapter">
        
        <a href="../Collecting_User_Input_with_Forms/Installing_ZF3_form_components.html">
            <img alt="Previous Chapter" src="../../assets/images/left.png"><span class="nav-btn-text">Previous</span>
        </a>
        </div>    
    <div class="contents">
        <a href="../toc.html">
            <img alt="Contents" src="../../assets/images/book.png"><span class="nav-btn-text">Contents</span>
        </a>
    </div>
    <div class="next-chapter">
                <a href="../Collecting_User_Input_with_Forms/Forms_and_Model_View_Controller.html">
            <span class="nav-btn-text">Next</span><img alt="Next Chapter" src="../../assets/images/right.png">
        </a>
            </div>
        <div class="current-chapter">
        <a href="../Collecting_User_Input_with_Forms.html">
            <img alt="Contents" src="../../assets/images/upload.png"><span class="nav-btn-text">Collecting User Input with Forms</span>
        </a>
    </div>
    </div>

﻿<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<!-- Using Zend Framework 3 Book - Chapter - Adaptive -->
<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-3933778336056438"
     data-ad-slot="4531860323"
     data-ad-format="auto"></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>

<!-- Chapter content -->
<div id="chapter_content">

<h2 id="Retrieving_Form_Data_in_a_Controller_s_Action">7.5. Retrieving Form Data in a Controller's Action</h2>
<p>The website user typically works with the form in the following order:</p>
<ul>
<li>First, a controller's action is executed rendering the web page 
containing the form prompting the site user for input.
Once the user fills the form fields, they click the <em>Submit</em> button,
and this generates an HTTP request and sends the data to the server. </li>
<li>Second, in your controller's action method, you can 
extract the submitted data from POST (and/or GET) variables,
and display the page with the results of the form processing.</li>
</ul>
<p>Typically these two web pages are handled by <em>the same</em> controller action. </p>
<p>In the following example, we will show how you can create a controller action 
for displaying the feedback form and retrieving the data submitted by the user. 
To start, add the <em>contact-us.phtml</em> view template in the <em>application/index/</em> directory under 
the module's <em>view/</em> directory (see figure 7.6 for example).</p>
<p><span class="image-wrapper">
<a target="_blank" href="../images/forms/contactus_file.png">
<img src="../images/forms/contactus_file.png" alt="Figure 7.6. Creating the contact-us.phtml file" /></a>
<span class="image-caption">Figure 7.6. Creating the contact-us.phtml file</span>
</span>
</p>
<p>Put the HTML markup code of the feedback form from the previous section into the view
template file.</p>
<p>Then, add the <code>contactUsAction()</code> action method to the <code>IndexController</code> class. In the action method, we 
want to extract raw data from the feedback form submitted by the site user:</p>
<pre class="line-numbers"><code class="language-php">&lt;?php
namespace Application\Controller;

// ...

class IndexController extends AbstractActionController 
{
  // This action displays the feedback form
  public function contactUsAction() 
  {
    // Check if user has submitted the form
    if($this-&gt;getRequest()-&gt;isPost()) {
      
	  // Retrieve form data from POST variables
	  $data = $this-&gt;params()-&gt;fromPost();     
	  
	  // ... Do something with the data ...
	  var_dump($data);	  
    } 
        
    // Pass form variable to view
    return new ViewModel([
          'form' =&gt; $form
       ]);
  }
}
</code></pre>
<p>In the code above, we define the <code>contactUsAction()</code> action method in the 
<code>IndexController</code> class (line 9). </p>
<p>Then, in line 12, we check whether the request is a POST request (checking 
the starting line of the HTTP request). Typically, the form uses the POST method
for submitting the data. For this reason, we can detect if the form is submitted or not
by checking the starting line of the HTTP request.</p>
<p>In line 15 we retrieve the raw data submitted by the user. We extract all the POST variables
with the help of the <code>Params</code> controller plugin. The data is returned in the form of an array and
saved into the <code>$data</code> variable. </p>
<p>Finally, we have to add a literal route to make a short and memorable URL
for the <em>Contact Us</em> page. Add the following <code>contactus</code> key to the routing configuration in the 
<em>module.config.php</em> file:</p>
<pre class=""><code class="language-php">&lt;?php
return [
  // ...
  'router' =&gt; [
    'routes' =&gt; [
      // Add the following routing rule for the "Contact Us" page 
      'contactus' =&gt; [
        'type' =&gt; Literal::class,
          'options' =&gt; [
             'route'    =&gt; '/contactus',
             'defaults' =&gt; [
               'controller' =&gt; Controller\IndexController::class,
               'action'     =&gt; 'contactUs',
             ],
           ],
         ],
       ],		 
    ],
  ],  
  // ...
];

</code></pre>
<p>Now, if you type the "http://localhost/contactus" URL in your web browser's navigation bar,
you should see the page as in figure 7.7. </p>
<p><span class="image-wrapper">
<a target="_blank" href="../images/forms/feedback_form.png">
<img src="../images/forms/feedback_form.png" alt="Figure 7.7. Feedback Form" /></a>
<span class="image-caption">Figure 7.7. Feedback Form</span>
</span>
</p>
<p>Enter an E-mail, subject, and body text and
click the <em>Submit</em> button on the form. The data will be sent to the server, and finally extracted
in the <code>IndexController::contactUsAction()</code> method.</p>
<p>Below, an example of the <code>$data</code> array (produced with the <code>var_dump()</code> 
PHP function) is shown. As you can see, the array contains a key for each form field, 
including the "submit" field.</p>
<pre class=""><code class="language-php">array (size=4)
    'email' =&gt; string 'name@example.com' (length=16)
    'subject' =&gt; string 'Happy New Year!' (length=15)
    'body' =&gt; string 'Dear Support, I'd like to thank you for the 
              excellent quality of your support service and wish you 
              a Happy New Year!' (length=118)
    'submit' =&gt; string 'Submit' (length=6)
</code></pre>
        
</div>

<!-- Ads -->
<div id="ads-chapter-bottom">
<div>
﻿<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<!-- Using Zend Framework 3 Chapter - Bottom - Adaptive -->
<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-3933778336056438"
     data-ad-slot="1546211126"
     data-ad-format="auto"></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script></div>
</div>
    
<!-- Navigation -->
<div class="navigation">
        <div class="current-chapter">
        <a href="../Collecting_User_Input_with_Forms.html">
            <img alt="Contents" src="../../assets/images/upload.png"><span class="nav-btn-text">Collecting User Input with Forms</span>
        </a>
    </div>
        <div class="prev-chapter">
        
        <a href="../Collecting_User_Input_with_Forms/Installing_ZF3_form_components.html">
            <img alt="Previous Chapter" src="../../assets/images/left.png"><span class="nav-btn-text">Previous</span>
        </a>
        </div>    
    <div class="contents">
        <a href="../toc.html">
            <img alt="Contents" src="../../assets/images/book.png"><span class="nav-btn-text">Contents</span>
        </a>
    </div>
    <div class="next-chapter">
                <a href="../Collecting_User_Input_with_Forms/Forms_and_Model_View_Controller.html">
            <span class="nav-btn-text">Next</span><img alt="Next Chapter" src="../../assets/images/right.png">
        </a>
            </div>        
</div>

<div id="disqus_thread"></div>

        
</div>
<footer>
    <div class="footer">
        <div class="footer-body">
            <div class="copyright">
                Copyright (c) 2018 by Oleg Krivtsov            </div>
            <div class="generated-by">
                Generated using <a href="https://github.com/olegkrivtsov/openbook">OpenBook</a>
            </div>
        </div>    
    </div>
</footer>

<a href="#0" class="cd-top">Top</a>

<script src="../../assets/js/jquery.min.js"></script>
<script src="../../assets/js/loadCSS.js"></script>

<script src="../../assets/js/prism.js"></script>

<script>
var disqus_config = function () {
this.page.url = window.location.href; // Replace PAGE_URL with your page's canonical URL variable
this.page.identifier = ''; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
};

(function() { // DON'T EDIT BELOW THIS LINE
var d = document, s = d.createElement('script');

s.src = '//using-zend-framework-3-book.disqus.com/embed.js';

s.setAttribute('data-timestamp', +new Date());
(d.head || d.body).appendChild(s);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>
<script>
loadCSS("../../assets/css/prism.css");
</script>

<script>
jQuery(document).ready(function($){
    // browser window scroll (in pixels) after which the "back to top" link is shown
    var offset = 300,
    //browser window scroll (in pixels) after which the "back to top" link opacity is reduced
    offset_opacity = 1200,
    //duration of the top scrolling animation (in ms)
    scroll_top_duration = 700,
    //grab the "back to top" link
    $back_to_top = $('.cd-top');

    //hide or show the "back to top" link
    $(window).scroll(function(){
            ( $(this).scrollTop() > offset ) ? $back_to_top.addClass('cd-is-visible') : $back_to_top.removeClass('cd-is-visible cd-fade-out');
            if( $(this).scrollTop() > offset_opacity ) { 
                    $back_to_top.addClass('cd-fade-out');
            }
    });

    //smooth scroll to top
    $back_to_top.on('click', function(event){
            event.preventDefault();
            $('body,html').animate({
                    scrollTop: 0 ,
                    }, scroll_top_duration
            );
    });

});
</script>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-80824388-1', 'auto');
  ga('send', 'pageview');

</script>

</body>
</html>    

