<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="description" content="A free and open-source book about Zend Framework">
<meta name="keywords" content="php,zend framework,book,tutorial,documentation,learn,free">
<meta name="author" content="(c) 2017 by Oleg Krivtsov">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link href="../../favicon.ico" rel="shortcut icon" type="image/ico" />
<link href="../../assets/css/style.css" type="text/css" rel="stylesheet" />
<title>An Example PHP Website -- Using Zend Framework 3</title>
</head>
<body>
<header>
    <div class="header">
        <div class="header-body">
            <div class="book-title">
                <a href="../../index.html">Using Zend Framework 3</a>
            </div>
            <div class="book-subtitle">
                A free and open-source book about Zend Framework            </div>
            <nav>
                <div class="menu">
                                        <div class="link">
                        <a href="https://olegkrivtsov.github.io/using-zend-framework-3-book/html">Read</a>
                    </div>
                                        <div class="link">
                        <a href="https://github.com/olegkrivtsov/using-zf3-book-samples">Samples</a>
                    </div>
                                        <div class="link">
                        <a href="https://github.com/olegkrivtsov/using-zend-framework-3-book">Contribute</a>
                    </div>
                    
                </div>
            </nav>
        </div>    
    </div>
</header>    
<div id="container">
<!-- Navigation -->
<div class="navigation">
    <div class="prev-chapter">
        
        <a href="../Introduction_to_Zend_Framework_3/What_is_Zend_Framework_3_.html">
            <img alt="Previous Chapter" src="../../assets/images/left.png"><span class="nav-btn-text">Previous</span>
        </a>
        </div>    
    <div class="contents">
        <a href="../toc.html">
            <img alt="Contents" src="../../assets/images/book.png"><span class="nav-btn-text">Contents</span>
        </a>
    </div>
    <div class="next-chapter">
                <a href="../Introduction_to_Zend_Framework_3/License.html">
            <span class="nav-btn-text">Next</span><img alt="Next Chapter" src="../../assets/images/right.png">
        </a>
            </div>
        <div class="current-chapter">
        <a href="../Introduction_to_Zend_Framework_3.html">
            <img alt="Contents" src="../../assets/images/upload.png"><span class="nav-btn-text">Introduction to Zend Framework 3</span>
        </a>
    </div>
    </div>

﻿<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<!-- Using Zend Framework 3 Book - Chapter - Adaptive -->
<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-3933778336056438"
     data-ad-slot="4531860323"
     data-ad-format="auto"></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>

<!-- Chapter content -->
<div id="chapter_content">

<h2 id="An_Example_PHP_Website">1.2. An Example PHP Website</h2>
<p>To demonstrate you how difficult it is to write a website <em>without</em> a PHP framework, here we 
will write a very simple website consisting of three HTML pages: <em>Home</em>, <em>Login</em> and <em>Logout</em>. 
For this example, we won't use any framework and will try to use only "pure" PHP.</p>
<blockquote class="notquote information" data-type="information"><p> Don't be confused - writing a website with a PHP framework may also be difficult, but
 with a framework you will do that in a consistent and secure manner. </p>
</blockquote><h3 id="Home_Page">1.2.1. Home Page</h3>
<blockquote class="notquote information" data-type="information"><p> When you write a website in PHP, you put your code into a file with the <em>.php</em> extension. Such a file is called
a PHP <em>script</em>. </p>
</blockquote><p>First, let's implement the <em>Home</em> page for the website. To do that, create the <em>index.php</em> file in your Apache
document root directory and put the following code into it:</p>
<blockquote class="notquote tip" data-type="tip"><p> To understand the code below, you need to have some experience with PHP. If you have no experience 
 with PHP, it would be good if you refer to some PHP tutorial,
 like <a href="http://www.w3schools.com/php/">w3schools.com</a>.</p>
</blockquote><pre class=""><code class="language-php">&lt;?php 
// index.php
session_start();

// If user is logged in, retrieve identity from session.
$identity = null;
if (isset($_SESSION['identity'])) {
    $identity = $_SESSION['identity'];
}
?&gt;

&lt;!DOCTYPE html&gt;
&lt;html&gt;
    &lt;head&gt;
        &lt;title&gt;Home page&lt;/title&gt;
    &lt;/head&gt;
    &lt;body&gt;
        &lt;h1&gt;Home&lt;/h1&gt;
        &lt;?php if ($identity==null): ?&gt;
        &lt;a href="login.php"&gt;Sign in&lt;/a&gt;
        &lt;?php else: ?&gt;
        &lt;strong&gt;Welcome, &lt;?= $identity ?&gt;&lt;/strong&gt; &lt;a href="logout.php"&gt;Sign out&lt;/a&gt;
        &lt;?php endif; ?&gt;
        
        &lt;p&gt;
            This is a simple website to demonstrate the advantages of a PHP framework
            and disadvantages of "pure" PHP.
        &lt;/p&gt;
    &lt;/body&gt;
&lt;/html&gt;
</code></pre>
<p>If you now enter the "http://localhost/index.php" in your browser (like Google Chrome or Firefox), you
should see the page like below:</p>
<p><span class="image-wrapper">
<a target="_blank" href="../images/intro/simple_home_page.png">
<img src="../images/intro/simple_home_page.png" alt="A simple Home page" /></a>
<span class="image-caption">A simple Home page</span>
</span>
</p>
<h3 id="Login_Page">1.2.2. Login Page</h3>
<p>Next, let's implement the <em>Login</em> page. Such a page would have a form with the <em>E-mail</em> 
and <em>Password</em> fields. Once the user submits the form, he passes the authentication 
and his identity is saved to PHP session. The script would look like below:</p>
<pre class=""><code class="language-php">&lt;?php 
// login.php
session_start();

// If user is logged in, redirect him to index.php
if (isset($_SESSION['identity'])) {
    header('Location: index.php');
    exit;
}

// Check if form is submitted.
$submitted = false;
if ($_SERVER['REQUEST_METHOD']=='POST') {
    
    $submitted = true;
    
    // Extract form data.
    $email = $_POST['email'];
    $password = $_POST['password'];
    
    // Authenticate user.
    $authenticated = false;
    if ($email=='admin@example.com' &amp;&amp; $password=='Secur1ty') {
        $authenticated = true;
        
        // Save identity to session.
        $_SESSION['identity'] = $email;
        
        // Redirect the user to index.php.
        header('Location: index.php');
        exit;
    }
}
?&gt;

&lt;!DOCTYPE html&gt;
&lt;html&gt;
    &lt;head&gt;
        &lt;title&gt;Login page&lt;/title&gt;
    &lt;/head&gt;
    &lt;body&gt;
        &lt;h1&gt;Sign in&lt;/h1&gt;
        &lt;?php if ($submitted &amp;&amp; !$authenticated): ?&gt;
            &lt;div class="alert"&gt;
                Invalid credentials.
            &lt;/div&gt;
        &lt;?php endif; ?&gt;
        &lt;form name="login-form" action="/login.php" method="POST"&gt;
            &lt;label for="email"&gt;E-mail&lt;/label&gt;
            &lt;input type="text" name="email"&gt;
            &lt;br&gt;
            &lt;label for="password"&gt;Password&lt;/label&gt;
            &lt;input type="password" name="password"&gt;
            &lt;br&gt;
            &lt;input type="submit" name="submit" value="Sign In"&gt;
        &lt;/form&gt;
    &lt;/body&gt;
&lt;/html&gt;
</code></pre>
<p>If you open the "http://localhost/login.php" URL in your browser, you should see something like below:</p>
<p><span class="image-wrapper">
<a target="_blank" href="../images/intro/simple_login_page.png">
<img src="../images/intro/simple_login_page.png" alt="A simple Login page" /></a>
<span class="image-caption">A simple Login page</span>
</span>
</p>
<blockquote class="notquote tip" data-type="tip"><p> To log in, use the <code>admin@example.com</code> and <code>Secur1ty</code> as your E-mail and password, respectively.</p>
</blockquote><h3 id="Logout_Page">1.2.3. Logout Page</h3>
<p>And finally, let's implement the <em>Logout</em> page that will clear user identity from session:</p>
<pre class=""><code class="language-php">&lt;?php 
// logout.php
session_start();

unset($_SESSION['identity']);
header('Location: index.php');
exit;
</code></pre>
<blockquote class="notquote tip" data-type="tip"><p> The complete code of this simple website can be found in 
 <a href="https://github.com/olegkrivtsov/using-zf3-book-samples/tree/master/purephp">Pure PHP</a> sample bundled with this book.</p>
</blockquote><h3 id="Reviewing_the_Code">1.2.4. Reviewing the Code</h3>
<p>The above scripts are not only a typical example of a "pure" PHP website. It is also an example of 
how you <em>should not</em> write your websites (even simple websites). What's bad about it?</p>
<ol>
<li><p>The <em>index.php</em> and <em>login.php</em> scripts tend to merge all the code into a single file. 
You do not have any separation of concerns, which makes your code too much complex.
Intuitively, you understand that it would 
be more convenient to split the code responsible for user authentication and the code 
responsible for presentation (HTML rendering).</p>
</li>
<li><p>The URLs of your web pages look ugly (for example, "http://localhost/index.php"). We would like to hide
that .php extension at all. And what happens when a web user tries to visit a page that doesn't exist? 
We would like to redirect the user to an error page in such case.</p>
</li>
<li><p>What if this website grows in size? How would you organise your code? A PHP script per web-page?
And what if you want to reuse some of your PHP scripts in other websites without changes? Intuitively
you might understand that it would be useful to organise the code in some kind of reusable <em>modules</em>.</p>
</li>
<li><p>Both <em>index.php</em> and <em>login.php</em> scripts contain common HTML markup. Why do we copy &amp; paste
this common layout in every PHP script? We would like to reuse the same master layout on all 
(or almost all) pages.</p>
</li>
<li><p>The <em>login.php</em> script has problems with security, because we didn't implement any validation of POST variables.
PHP session is also subject to hacking. And the <em>login.php</em> PHP script will be located under the Apache
document root directory, which is not very secure (it would be better to place it in a place not accessible 
for web users). The <em>index.php</em> is also insecure, because we did not filter the PHP output (it is subject to XSS attacks).   </p>
</li>
<li><p>These scripts don't use any PHP classes. Encapsulating functionality into classes in theory would make 
the code well structured and easy to support.   </p>
</li>
<li><p>In these scripts you have to write your own implementation of user authentication (and so on). Why do we reinvent the wheel 
and not use a well-designed library for that?   </p>
</li>
</ol>
<p>The above problems are easily solved when you write a website within a framework (like Zend Framework 3):</p>
<ol>
<li><p>In ZF3, you use the <em>Model-View-Controller</em> design pattern, splitting your PHP code into models
(the code responsible for authentication would go here), views (the code responsible for HTML rendering
would go here) and controllers (the code responsible for retrieving POST variables would go here).</p>
</li>
<li><p>The ZF3 <em>routing</em> allows to make URLs professionally looking by hiding the .php extensions. How URLs
can look like are defined by strict rules. If a user tries to see a non-existing page, he is automatically
redirected to a standard error page.</p>
</li>
<li><p>In ZF3, you can use the concept of <em>module</em>. This allows to conveniently separate your models, views and
controllers in autonomous unit (module) and easily reuse that unit in another project. </p>
</li>
<li><p>In ZF3 you can define a common <em>layout</em> view template and reuse it on all (or most) web pages.</p>
</li>
<li><p>ZF3 provides you various security features like form filters and validators, output escapers, session validators, 
cryptography
algorithms and so on. In a ZF3 website, only <em>index.php</em> is accessible for web users, all other PHP scripts
are located outside of Apache document root directory.</p>
</li>
<li><p>In a ZF3 website, you put your code into classes, which makes it well-organised.</p>
</li>
<li><p>ZF3 provides you many components that you can use in your website: a component for authentication, a component
for working with forms, and so on.   </p>
</li>
</ol>
<blockquote class="notquote tip" data-type="tip"><p> Now you may have some idea of the advantages of Zend Framework 3 and what it can do for you. In the next
   sections, we will describe ZF3 in more details.</p>
</blockquote>        
</div>

<!-- Ads -->
<div id="ads-chapter-bottom">
<div>
﻿<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<!-- Using Zend Framework 3 Chapter - Bottom - Adaptive -->
<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-3933778336056438"
     data-ad-slot="1546211126"
     data-ad-format="auto"></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script></div>
</div>
    
<!-- Navigation -->
<div class="navigation">
        <div class="current-chapter">
        <a href="../Introduction_to_Zend_Framework_3.html">
            <img alt="Contents" src="../../assets/images/upload.png"><span class="nav-btn-text">Introduction to Zend Framework 3</span>
        </a>
    </div>
        <div class="prev-chapter">
        
        <a href="../Introduction_to_Zend_Framework_3/What_is_Zend_Framework_3_.html">
            <img alt="Previous Chapter" src="../../assets/images/left.png"><span class="nav-btn-text">Previous</span>
        </a>
        </div>    
    <div class="contents">
        <a href="../toc.html">
            <img alt="Contents" src="../../assets/images/book.png"><span class="nav-btn-text">Contents</span>
        </a>
    </div>
    <div class="next-chapter">
                <a href="../Introduction_to_Zend_Framework_3/License.html">
            <span class="nav-btn-text">Next</span><img alt="Next Chapter" src="../../assets/images/right.png">
        </a>
            </div>        
</div>

<div id="disqus_thread"></div>

        
</div>
<footer>
    <div class="footer">
        <div class="footer-body">
            <div class="copyright">
                Copyright (c) 2017 by Oleg Krivtsov            </div>
            <div class="generated-by">
                Generated using <a href="https://github.com/olegkrivtsov/openbook">OpenBook</a>
            </div>
        </div>    
    </div>
</footer>

<a href="#0" class="cd-top">Top</a>

<script src="../../assets/js/jquery.min.js"></script>
<script src="../../assets/js/loadCSS.js"></script>

<script src="../../assets/js/prism.js"></script>

<script>
var disqus_config = function () {
this.page.url = window.location.href; // Replace PAGE_URL with your page's canonical URL variable
this.page.identifier = ''; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
};

(function() { // DON'T EDIT BELOW THIS LINE
var d = document, s = d.createElement('script');

s.src = '//using-zend-framework-3-book.disqus.com/embed.js';

s.setAttribute('data-timestamp', +new Date());
(d.head || d.body).appendChild(s);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>
<script>
loadCSS("../../assets/css/prism.css");
</script>

<script>
jQuery(document).ready(function($){
    // browser window scroll (in pixels) after which the "back to top" link is shown
    var offset = 300,
    //browser window scroll (in pixels) after which the "back to top" link opacity is reduced
    offset_opacity = 1200,
    //duration of the top scrolling animation (in ms)
    scroll_top_duration = 700,
    //grab the "back to top" link
    $back_to_top = $('.cd-top');

    //hide or show the "back to top" link
    $(window).scroll(function(){
            ( $(this).scrollTop() > offset ) ? $back_to_top.addClass('cd-is-visible') : $back_to_top.removeClass('cd-is-visible cd-fade-out');
            if( $(this).scrollTop() > offset_opacity ) { 
                    $back_to_top.addClass('cd-fade-out');
            }
    });

    //smooth scroll to top
    $back_to_top.on('click', function(event){
            event.preventDefault();
            $('body,html').animate({
                    scrollTop: 0 ,
                    }, scroll_top_duration
            );
    });

});
</script>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-80824388-1', 'auto');
  ga('send', 'pageview');

</script>

</body>
</html>    

