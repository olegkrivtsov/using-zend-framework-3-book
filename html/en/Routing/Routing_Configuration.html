<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="description" content="A free and open-source book about Zend Framework">
<meta name="keywords" content="php,zend framework,book,tutorial,documentation,learn,free">
<meta name="author" content="(c) 2016 by Oleg Krivtsov">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link href="../../favicon.ico" rel="shortcut icon" type="image/ico" />
<link href="../../assets/css/style.css" type="text/css" rel="stylesheet" />
<title>Routing Configuration -- Using Zend Framework 3</title>
</head>
<body>
<header>
    <div class="header">
        <div class="header-body">
            <div class="book-title">
                <a href="../../index.html">Using Zend Framework 3</a>
            </div>
            <div class="book-subtitle">
                A free and open-source book about Zend Framework            </div>
            <nav>
                <div class="menu">
                                        <div class="link">
                        <a href="https://olegkrivtsov.github.io/using-zend-framework-3-book/html">Read</a>
                    </div>
                                        <div class="link">
                        <a href="https://github.com/olegkrivtsov/using-zf3-book-samples">Samples</a>
                    </div>
                                        <div class="link">
                        <a href="https://github.com/olegkrivtsov/using-zend-framework-3-book">Contribute</a>
                    </div>
                    
                </div>
            </nav>
        </div>    
    </div>
</header>    
<div id="container">
<!-- Navigation -->
<div class="navigation">
    <div class="prev-chapter">
        
        <a href="../Routing/Combining_Route_Types.html">
            <img alt="Previous Chapter" src="../../assets/images/left.png"><span class="nav-btn-text">Previous</span>
        </a>
        </div>    
    <div class="contents">
        <a href="../toc.html">
            <img alt="Contents" src="../../assets/images/book.png"><span class="nav-btn-text">Contents</span>
        </a>
    </div>
    <div class="next-chapter">
                <a href="../Routing/Literal_Route_Type.html">
            <span class="nav-btn-text">Next</span><img alt="Next Chapter" src="../../assets/images/right.png">
        </a>
            </div>
        <div class="current-chapter">
        <a href="../Routing.html">
            <img alt="Contents" src="../../assets/images/upload.png"><span class="nav-btn-text">Routing</span>
        </a>
    </div>
    </div>

﻿<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<!-- Using Zend Framework 3 Book - Chapter - Adaptive -->
<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-3933778336056438"
     data-ad-slot="4531860323"
     data-ad-format="auto"></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>

<!-- Chapter content -->
<div id="chapter_content">

<h2 id="header-108">5.4. Routing Configuration</h2>
<p>You typically do not create the route stack (or tree) yourself, instead you provide the 
instructions for ZF3 on how to do that. </p>
<p>The routing configuration for a module is stored in <em>module.config.php</em> configuration file:</p>
<pre class="line-numbers"><code class="language-php">&lt;?php
use Zend\Router\Http\TreeRouteStack;

return [
  //...
  'router' =&gt; [
    'router_class' =&gt; TreeRouteStack::class,
    'routes' =&gt; [	
      // Register your routing rules here...	
    ],
    'default_params' =&gt; [	
      // Specify default parameters here for all routes here ...	
    ]
  ],
];
</code></pre>
<p>Above, in line 6 we have the <em>router</em> key, under which there is the <em>routes</em> subkey (line 8),
containing the routing rules. </p>
<p>You can specify which top-level route class to use (either <code>TreeRouteStack</code> or <code>SimpleRouteStack</code>) 
with the <code>router_class</code> parameter (line 7). If this parameter is not present,
the <code>TreeRouteStack</code> is used by default.</p>
<p>You can use the optional <code>default_params</code> key (line 11) to define the <em>default values</em> for parameters 
for all routes at once. However, you typically do not use this key and define
the defaults on a per-route basis. </p>
<blockquote class="notquote information" data-type="information"><p> We will show how you extract parameters from route later in this chapter. </p>
</blockquote><h3 id="header-109">5.4.1. Configuration for Simple Routes</h3>
<p>A typical route has the <em>name</em>, <em>type</em> and <em>options</em>: </p>
<ul>
<li>The <em>name</em> is used to uniquely identify the route. </li>
<li>The <em>type</em> defines the fully qualified name of the route type (PHP class which implements 
the matching algorithm). </li>
<li>The <em>options</em> is an array that includes the <em>route</em> 
string which should be compared against the URL part, and several parameters called the <em>defaults</em>.</li>
</ul>
<p>Configuration for each route under the <code>routes</code> subkey may have the following format:</p>
<pre class=""><code class="language-php">'&lt;route_name&gt;' =&gt; [
  'type' =&gt; '&lt;route_type_class&gt;',
  'priority' =&gt; &lt;priority&gt;,
  'options' =&gt; [
    'route' =&gt; '&lt;route&gt;',
    'defaults' =&gt; ]
      //...
    ],
  ],  
]
</code></pre>
<p>Above, the <code>&lt;route_name&gt;</code> placeholder should be the name of the route. A route name must be in lower case,
like "home" or "about". The <code>type</code> key specifies the fully qualified route class name.</p>
<p>The optional <code>priority</code> key allows to define the priority (which should be an integer number) 
of the route in the priority list (routes with higher priority will be visited first). If you 
omit the <code>priority</code> key, the routes will be visited in the LIFO <sup id="fnref:lifo"><a href="#fn:lifo" class="footnote-ref" rel="footnote">4</a></sup> order.</p>
<blockquote class="notquote information" data-type="information"><p> Routes having equal priority will be visited in the LIFO order. Thus, for the best performance, you should 
 register routes that will match most often in the last turn, and least common routes should be registered first.</p>
</blockquote><footnotes id="fn:lifo"><p><sup>4)</sup> LIFO (stands for Last In, First Out) is used to organize items in a stack, where
the topmost item, which is added last, is taken out first.</p>
</footnotes>
<p>The <code>options</code> key defines the array of route's options. We will discuss the options 
in the following sections of this chapter.</p>
<h3 id="header-110">5.4.2. Configuration for Nested Routes</h3>
<p>To organize routes in a subtree, you add the <code>child_routes</code> key to the route definition,
and add your child routes under that key, like below:</p>
<pre class=""><code class="language-php">'&lt;route_name&gt;' =&gt; [
  'type' =&gt; '&lt;route_type_class&gt;',
  'priority' =&gt; &lt;priority&gt;,
  'options' =&gt; [
    //...
  ],
  'child_routes' =&gt; [
    // Add child routes here.
    // ...
  ]	
],
</code></pre>
<p>If you need to organize the routes in a chain (degenerated subtree), you add the 
<code>chain_routes</code> key to your route configuration:</p>
<pre class=""><code class="language-php">'&lt;route_name&gt;' =&gt; [
  'type' =&gt; '&lt;route_type_class&gt;',
  'priority' =&gt; &lt;priority&gt;,
  'options' =&gt; [
    //...
  ],
  'chain_routes' =&gt; [
    // Add chained routes here.
    // ...
  ]	
],
</code></pre>
<blockquote class="notquote tip" data-type="tip"><p> Looking at the two examples above, you won't see the explicit usage of <code>Part</code> and
 <code>Chain</code> route types, because (for your convenience) they are used by the ZF3 automatically when
 it encounters the <code>child_routes</code> and <code>chain_routes</code> keys in your routing configuration.</p>
</blockquote><h3 id="header-111">5.4.3. Default Routing Configuration in Zend Skeleton Application</h3>
<p>Now that you know how to configure routes and organize them in compound structures, 
let's look at the real life example. In a fresh Zend Skeleton Application, the routing 
configuration looks like below:</p>
<pre class="line-numbers"><code class="language-php">&lt;?php
use Zend\Router\Http\Literal;
use Zend\Router\Http\Segment;

return [
  'router' =&gt; [
        'routes' =&gt; [
            'home' =&gt; [
                'type' =&gt; Literal::class,
                'options' =&gt; [
                    'route'    =&gt; '/',
                    'defaults' =&gt; [
                        'controller' =&gt; Controller\IndexController::class,
                        'action'     =&gt; 'index',
                    ],
                ],
            ],
            'application' =&gt; [
                'type'    =&gt; Segment::class,
                'options' =&gt; [
                    'route'    =&gt; '/application[/:action]',
                    'defaults' =&gt; [
                        'controller'    =&gt; Controller\IndexController::class,
                        'action'        =&gt; 'index',
                    ],
                ],
            ],
        ],
    ],
    
  //...
];
</code></pre>
<p>In the configuration presented above, we have two routing rules listed in turn: 
first we have the "home" route (line 8) and then we have the "application" route (line 18).</p>
<p>The "home" route maps the empty URL path to the "index" action of the <code>IndexController</code> controller. For example,
enter "http://localhost/" in your browser to see the Home page of your website. This route
is of type "Literal".</p>
<p>The "application" route (of type "Segment") maps URLs looking like "http://localhost/application", 
"http://localhost/application/about", "http://localhost/application/news", etc onto the corresponding
action of the <code>IndexController</code> controller. The actual action name is determined by the "action" parameter.
The default value for this parameter is "index". That means that if you do not specify any action, the request
will be dispatched to "index" action.</p>
<p>This configuration corresponds to the tree route stack shown in figure 5.5:</p>
<p><span class="image-wrapper">
<a target="_blank" href="../images/routing/skeleton_route_tree.png">
<img src="../images/routing/skeleton_route_tree.png" alt="Figure 5.5. Default route stack in the Skeleton Application" /></a>
<span class="image-caption">Figure 5.5. Default route stack in the Skeleton Application</span>
</span>
</p>
<p>In the next sections, we will provide some examples on how to use the route types
in your website.</p>
        
</div>

<!-- Ads -->
<div id="ads-chapter-bottom">
<div>
﻿<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<!-- Using Zend Framework 3 Chapter - Bottom - Adaptive -->
<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-3933778336056438"
     data-ad-slot="1546211126"
     data-ad-format="auto"></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
</div>
</div>
    
<!-- Navigation -->
<div class="navigation">
        <div class="current-chapter">
        <a href="../Routing.html">
            <img alt="Contents" src="../../assets/images/upload.png"><span class="nav-btn-text">Routing</span>
        </a>
    </div>
        <div class="prev-chapter">
        
        <a href="../Routing/Combining_Route_Types.html">
            <img alt="Previous Chapter" src="../../assets/images/left.png"><span class="nav-btn-text">Previous</span>
        </a>
        </div>    
    <div class="contents">
        <a href="../toc.html">
            <img alt="Contents" src="../../assets/images/book.png"><span class="nav-btn-text">Contents</span>
        </a>
    </div>
    <div class="next-chapter">
                <a href="../Routing/Literal_Route_Type.html">
            <span class="nav-btn-text">Next</span><img alt="Next Chapter" src="../../assets/images/right.png">
        </a>
            </div>        
</div>

<div id="disqus_thread"></div>

        
</div>
<footer>
    <div class="footer">
        <div class="footer-body">
            <div class="copyright">
                Copyright (c) 2016 by Oleg Krivtsov            </div>
            <div class="generated-by">
                Generated using <a href="https://github.com/olegkrivtsov/openbook">OpenBook</a>
            </div>
        </div>    
    </div>
</footer>

<a href="#0" class="cd-top">Top</a>

<script src="../../assets/js/jquery.min.js"></script>
<script src="../../assets/js/loadCSS.js"></script>

<script src="../../assets/js/prism.js"></script>

<script>
var disqus_config = function () {
this.page.url = window.location.href; // Replace PAGE_URL with your page's canonical URL variable
this.page.identifier = ''; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
};

(function() { // DON'T EDIT BELOW THIS LINE
var d = document, s = d.createElement('script');

s.src = '//using-zend-framework-3-book.disqus.com/embed.js';

s.setAttribute('data-timestamp', +new Date());
(d.head || d.body).appendChild(s);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>
<script>
loadCSS("../../assets/css/prism.css");
</script>

<script>
jQuery(document).ready(function($){
    // browser window scroll (in pixels) after which the "back to top" link is shown
    var offset = 300,
    //browser window scroll (in pixels) after which the "back to top" link opacity is reduced
    offset_opacity = 1200,
    //duration of the top scrolling animation (in ms)
    scroll_top_duration = 700,
    //grab the "back to top" link
    $back_to_top = $('.cd-top');

    //hide or show the "back to top" link
    $(window).scroll(function(){
            ( $(this).scrollTop() > offset ) ? $back_to_top.addClass('cd-is-visible') : $back_to_top.removeClass('cd-is-visible cd-fade-out');
            if( $(this).scrollTop() > offset_opacity ) { 
                    $back_to_top.addClass('cd-fade-out');
            }
    });

    //smooth scroll to top
    $back_to_top.on('click', function(event){
            event.preventDefault();
            $('body,html').animate({
                    scrollTop: 0 ,
                    }, scroll_top_duration
            );
    });

});
</script>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-80824388-1', 'auto');
  ga('send', 'pageview');

</script>

</body>
</html>    

